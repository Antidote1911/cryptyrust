[![Build status](https://ci.appveyor.com/api/projects/status/3yludsnwm5a1jnsa/branch/master?svg=true)](https://ci.appveyor.com/project/Antidote1911/cryptyrust/branch/master)
[![License: GPL3](https://img.shields.io/badge/License-GPL3-green.svg)](https://opensource.org/licenses/GPL-3.0)


# Cryptyrust
**Simple cross-platform gui and cli file encryption.**<br/>
Latest Windows x64 release is [here](https://github.com/Antidote1911/cryptyrust/releases/latest).

![Demo](demo.gif)

## Usage for CLI:
**Data Loss Disclaimer:**  
if you lose or forget your password, **your data cannot be recovered !**  
Use a password manager or another secure form of backup.<br/>

Exemples :
You can choose algorithm encryption with `-a aesgcm` for aes-gcm-siv or `-a chacha` for xchacha20poly1305. If not specified, cryptyrust use aes-gcm-siv. Decryption automatically detect the good algorithm. No need to specify `-a aesgcm` or `-a chacha`.

```bash
# encrypt the file test.mp4 with password 12345678 and décrypt it:
./cryptyrust_cli -e test.mp4 -p 12345678
./cryptyrust_cli -d test.mp4.crypty -p 12345678

# encrypt the file test.mp4 with password 12345678 with xchacha20poly1305 and décrypt it:
./cryptyrust_cli -e test.mp4 -p 12345678 -a chacha
./cryptyrust_cli -d test.mp4.crypty -p 12345678  

# Or you can enter an output file name with -o flag if you want:
./cryptyrust_cli -e test.mp4 -p 12345678 -o myEncryptedFile
./cryptyrust_cli -d myEncryptedFile -p 12345678 -o myDecryptedFile

# Or use stdout. Can be usefull for scripts:
./cryptyrust_cli -e test.mp4 -p 12345678 -O > test.enc
./cryptyrust_cli -d test.enc -p 12345678 -O > test.mp4
```

## Primitives:
- `Argon2` for password hash
- `aes-gcm-siv` [(Misuse-Resistant Authenticated Encryption Cipher)](https://github.com/miscreant/meta/wiki/Nonce-Reuse-Misuse-Resistance) in [Stream Mode](https://github.com/miscreant/meta/wiki/STREAM).
- `xchacha20poly1305` in [Stream Mode](https://github.com/miscreant/meta/wiki/STREAM).

It use primitives from [Rust Crypto](https://github.com/RustCrypto).

## Technical description: ##
**Password Derivation :**  
A 32 bytes "Rawkey" is generated by Argon2id from the user password and a 16 bytes random salt to prevent brute force attack. This "Rawkey" is used to encrypt with the selected algorithm.

**Nonce (or initialization vectors) :**
For aes-gcm-siv a 7 bytes nonce is randomly generated. (19 bytes for xchacha20poly1305). This nonce is used to encrypt with the selected algorithm and the RawKey. Nonce is always incremented before all steps to ensure to never reuse it with the same key. It is incremented after all encrypted chunk.

the output file is :
- Magic number (a simple signature to check if it's a Cryptyrust file. 4 bytes)
- The Argon2 Salt (16 bytes)
- Selected algorithm ('aesgcm' or 'chacha'. 6 bytes)
- Nonce (7 bytes for aes, 19 for chacha)
- encrypted chunk_1  ( BUFFER_SIZE + 16 bytes Authentication tag )
- encrypted chunk_2  ( BUFFER_SIZE + 16 bytes Authentication tag )
- ....etc


## Linux Compilation instructions:
In the root folder run `cargo build --release`
Executable will be at `target/release/cryptyrust_cli'.

## Windows Compilation instructions:

- Install [Visual Studio Build Tools 2019](https://visualstudio.microsoft.com/fr/thank-you-downloading-visual-studio/?sku=BuildTools&rel=16)  
- Make sure rust use msvc. Run in command line :
`rustup default stable-x86_64-pc-windows-msvc`
- Build rust CLI App and core project : `cargo build --release`

## C++ GUI Compilation instructions:
C++ GUI require Qt5 or Qt6 and Cryptyrust core build with `cargo build --release`.
After building the Rust cli and core with `cargo build --release`, Open qtgui/CMakeLists.txt with your IDE and build it. If You use qt creator, you can open project cryptyrust.pro to build it.


```bash
# With Linux command-line, open a terminal in qtgui folder
qmake cryptyrust.pro
make
```
```bash
# For Windows
cd qtgui
mkdir build
cd build
cmake -G "NMake Makefiles" -DCMAKE_BUILD_TYPE=Release ..
nmake
```
